<!DOCTYPE html>
<!-- Documento HTML5 -->

<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <!-- Suporte a acentuação e caracteres especiais -->

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Responsividade em dispositivos móveis -->

    <title>Atestado</title>

    <link href='https://cdn.boxicons.com/fonts/basic/boxicons.min.css' rel='stylesheet'>
    <!-- Biblioteca de ícones Boxicons -->

    <link rel="stylesheet" href="style2.css">
    <!-- Estilos personalizados -->
</head>
<body>

    <div class="menu">
        <!-- Menu lateral de navegação -->

        <ul>
            <li>
                <a href="inicio.html" class="nav-link">
                    <span class="item-icon"><i class='bx bx-square-small'></i></span>
                    <span class="item-txt">Início</span>
                </a>
            </li>
            <li>
                <a href="guia.html" class="nav-link">
                    <span class="item-icon"><i class='bx bx-home'></i></span>
                    <span class="item-txt">Guia</span>
                </a>
            </li>
            <li>
                <a href="contatos.html" class="nav-link">
                    <span class="item-icon"><i class='bx bx-contact-book'></i></span>
                    <span class="item-txt">Contato</span>
                </a>
            </li>
            <li>
                <a href="atestado.html" class="nav-link">
                    <span class="item-icon"><i class='bx bx-folder-up-arrow'></i></span>
                    <span class="item-txt">Enviar atestado</span>
                </a>
            </li>
        </ul>
    </div>

    <div class="conteudo">
        <!-- Área principal de conteúdo -->

        <h2>Atestado</h2>

        <br><form id="atestadoForm">
            <!-- Formulário para envio de atestado -->

            <div class="input-group">
                <input type="text" id="nome" placeholder=" " required>
                <label>Nome completo</label>
            </div>

            <div class="input-group">
                <input type="text" id="matricula" placeholder=" " required>
                <label>Matrícula</label>
            </div>

            <div class="input-group">
                <input type="text" id="turma" placeholder=" " required>
                <label>Código de turma</label>
            </div>

            <div class="input-group">
                <input type="email" id="email" placeholder=" " required>
                <label>Email institucional</label>
            </div>

            <div class="input-group">
                <input type="date" id="inicio" placeholder=" " required>
                <label>Data de início do atestado</label>
            </div>

            <div class="input-group">
                <input type="date" id="fim" placeholder=" " required>
                <label>Data de término do atestado</label>
            </div>

            <div class="input-group">
                <input type="file" id="arquivo" required>
                <label>Arquivo de atestado</label>
            </div>

            <button type="submit" class="enviar-btn">Enviar</button>
            <!-- Botão para enviar o formulário -->
        </form>

        <p id="mensagem"></p>
        <!-- Mensagem de feedback após envio -->
    </div>

    <script>
        // Captura o formulário e o elemento de mensagem
        const form = document.getElementById("atestadoForm");
        const mensagem = document.getElementById("mensagem");

        // Intercepta o envio do formulário
        form.addEventListener("submit", async function (e) {
            e.preventDefault();

            // Coleta os dados preenchidos
            const nome = document.getElementById("nome").value;
            const matricula = document.getElementById("matricula").value;
            const turma = document.getElementById("turma").value;
            const email = document.getElementById("email").value;
            const inicio = document.getElementById("inicio").value;
            const fim = document.getElementById("fim").value;
            const arquivo = document.getElementById("arquivo").files[0];

            // Obtém o nome do arquivo enviado
            const nomeArquivo = arquivo ? arquivo.name : "Sem arquivo";

            try {
                // Envia os dados para a API do SheetMonkey
                const resposta = await fetch("https://api.sheetmonkey.io/form/eHYZuuAGq5QL9wAZuB2wpj", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        nome: nome,
                        matricula: matricula,
                        turma: turma,
                        email: email,
                        dataInicio: inicio,
                        dataFim: fim,
                        nomeArquivo: nomeArquivo
                    })
                });

                // Verifica se o envio foi bem-sucedido
                if (resposta.ok) {
                    mensagem.textContent = "Atestado enviado com sucesso!";
                    mensagem.style.color = "green";
                    form.reset();
                } else {
                    mensagem.textContent = "Erro ao enviar. Tente novamente.";
                    mensagem.style.color = "red";
                }
            } catch (erro) {
                // Trata falhas de conexão
                mensagem.textContent = "Falha na conexão. Verifique sua internet.";
                mensagem.style.color = "orange";
            }
        });
    </script>

</body>
</html>
